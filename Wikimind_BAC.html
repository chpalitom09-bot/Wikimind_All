<!-- START OF FILE Wikimind_BAC.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-29XYBNJ2CB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-29XYBNJ2CB');
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YNR6KZQD5D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YNR6KZQD5D');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WikiMind BAC 2026 - Calculateur de Moyenne</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #ffffff;
            --text: #111111;
            --accent: #000000;
            --border: #e5e7eb;
            --card-bg: #f9fafb;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            overflow-x: hidden; /* Emp√™che le scroll horizontal */
        }

        /* Animations */
        .fade-in { animation: fadeIn 0.5s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }

        .input-group { transition: all 0.2s; }
        .input-group:focus-within { transform: scale(1.01); border-color: #000; }
        
        input[type="number"]::-webkit-inner-spin-button, 
        input[type="number"]::-webkit-outer-spin-button { 
            -webkit-appearance: none; margin: 0; 
        }

        /* WikiMind Branding Style */
        .wikimind-btn {
            background-color: var(--accent);
            color: white;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .wikimind-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .result-card {
            background: black;
            color: white;
            transition: 0.3s;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <header class="border-b border-gray-200 sticky top-0 bg-white/90 backdrop-blur-md z-50">
        <div class="max-w-5xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2 flex-shrink-0 cursor-pointer" onclick="location.href='Wikimind_home.html'">
                <div class="w-8 h-8 bg-black rounded-lg flex items-center justify-center text-white font-black text-sm flex-shrink-0 shadow-sm">W</div>
                <h1 class="text-xl font-black tracking-tighter uppercase italic whitespace-nowrap">WikiMind <span class="text-gray-400 not-italic font-medium">BAC</span></h1>
            </div>
            
            <div class="flex items-center gap-4">
                <!-- BOUTON MON COMPTE -->
                <a href="user.html" id="auth-btn" class="hidden md:flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-xs font-bold uppercase tracking-widest hover:bg-gray-200 transition">
                    <span>Mon Compte</span>
                </a>

                <a href="https://chpalitom09-bot.github.io/Wikimind/" target="_blank" 
                class="group flex items-center gap-2 text-sm font-medium hover:text-black transition-colors hidden sm:flex">
                    <span class="text-gray-500 group-hover:text-black transition">Besoin d'aide ?</span>
                    <span class="bg-gray-100 px-3 py-1.5 rounded-full font-bold border border-gray-200 group-hover:bg-black group-hover:text-white group-hover:border-black transition duration-300">
                        Parler √† @WikiMind
                    </span>
                </a>
                <a href="https://chpalitom09-bot.github.io/Wikimind/" target="_blank" class="sm:hidden w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full text-black">
                    ?
                </a>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-4xl mx-auto w-full px-6 py-12">
        
        <div class="text-center mb-12 fade-in" style="animation-delay: 0.1s;">
            <h2 class="text-4xl md:text-5xl font-black mb-4 tracking-tight">Simulateur BAC 2026</h2>
            <p class="text-gray-500">Calcul de moyenne pr√©cis avec sauvegarde automatique.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-10 fade-in" style="animation-delay: 0.2s;">
            <button onclick="setMode('general')" id="btn-general" class="stream-btn p-6 rounded-2xl border-2 border-gray-100 bg-white text-black text-left hover:scale-[1.02] transition shadow-sm">
                <div class="text-2xl mb-2">üéì</div>
                <div class="font-bold text-lg">G√©n√©ral</div>
                <div class="text-xs opacity-70">R√©forme 2026 standard</div>
            </button>
            <button onclick="setMode('bachibac')" id="btn-bachibac" class="stream-btn p-6 rounded-2xl border-2 border-gray-100 bg-white text-black text-left hover:scale-[1.02] transition shadow-sm">
                <div class="text-2xl mb-2">üá™üá∏</div>
                <div class="font-bold text-lg">BachiBac</div>
                <div class="text-xs text-gray-400">Section Binationale</div>
            </button>
            <button onclick="setMode('pro')" id="btn-pro" class="stream-btn p-6 rounded-2xl border-2 border-gray-100 bg-white text-black text-left hover:scale-[1.02] transition shadow-sm">
                <div class="text-2xl mb-2">üõ†Ô∏è</div>
                <div class="font-bold text-lg">Techno / Pro</div>
                <div class="text-xs text-gray-400">Coefficients modulables</div>
            </button>
        </div>

        <div id="calculator-container" class="fade-in hidden" style="animation-delay: 0.3s;">
            
            <div class="flex justify-between items-end mb-6 border-b border-gray-100 pb-2">
                <h3 class="font-bold text-xl uppercase tracking-widest" id="mode-title">Mati√®res</h3>
                <span class="text-xs font-mono bg-gray-100 px-2 py-1 rounded text-gray-500">Note / 20</span>
            </div>

            <div id="inputs-grid" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 pb-40">
                </div>

        </div>

    </main>

    <div id="result-bar" class="fixed bottom-0 left-0 w-full bg-white/95 backdrop-blur-md border-t border-gray-200 p-6 transform translate-y-full transition-transform duration-500 shadow-[0_-10px_40px_rgba(0,0,0,0.1)] z-40">
        <div class="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <div>
                <div class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 text-center md:text-left">Moyenne Estim√©e</div>
                <div class="flex items-center md:items-baseline gap-3 justify-center md:justify-start">
                    <span id="final-grade" class="text-5xl font-black tracking-tighter">--/20</span>
                    <span id="final-mention" class="px-3 py-1 rounded-full bg-black text-white text-xs font-bold uppercase hidden animate-pulse">Mention ?</span>
                </div>
            </div>
            
            <div class="flex gap-3 w-full md:w-auto">
                 <button onclick="resetCalculator()" class="flex-1 md:flex-none border border-gray-200 hover:border-black hover:bg-gray-50 px-6 py-3 rounded-xl font-bold text-sm uppercase transition text-gray-600">
                    R√©initialiser
                </button>
                <a href="https://chpalitom09-bot.github.io/Wikimind/" target="_blank" class="flex-1 md:flex-none wikimind-btn px-6 py-3 rounded-xl font-bold text-sm uppercase flex items-center justify-center gap-2">
                    <span>Analyser IA</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg>
                </a>
            </div>
        </div>
    </div>

    <!-- SCRIPT FIREBASE POUR HEADER -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAsV27OD4bARFOSDlZN1MAARSv9q2WBkdo",
            authDomain: "wikimind-pro.firebaseapp.com",
            projectId: "wikimind-pro",
            storageBucket: "wikimind-pro.firebasestorage.app",
            messagingSenderId: "154490257518",
            appId: "1:154490257518:web:3276b1e64f2db9894be67f"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        onAuthStateChanged(auth, (user) => {
            const btn = document.getElementById('auth-btn');
            if (btn) {
                if (user) {
                    btn.innerHTML = `<div class="w-2 h-2 rounded-full bg-green-500"></div> <span>Mon Espace</span>`;
                } else {
                    btn.innerHTML = `<span>Mon Compte</span>`;
                }
            }
        });
    </script>

    <script>
        // --- 1. CONFIGURATION DATA ---
        const DATA = {
            general: [
                { category: "√âpreuves Terminales (60%)" },
                { name: "Fran√ßais (√âcrit)", coef: 5 },
                { name: "Fran√ßais (Oral)", coef: 5 },
                { name: "Philosophie", coef: 8 },
                { name: "Grand Oral", coef: 10 },
                { name: "Sp√©cialit√© 1 (Terminale)", coef: 16 },
                { name: "Sp√©cialit√© 2 (Terminale)", coef: 16 },
                { category: "Contr√¥le Continu (40%)" },
                { name: "Sp√©cialit√© abandonn√©e (1√®re)", coef: 8 },
                { name: "Histoire-G√©o (Moyenne 1√®re+Term)", coef: 6 },
                { name: "LVA (Moyenne 1√®re+Term)", coef: 6 },
                { name: "LVB (Moyenne 1√®re+Term)", coef: 6 },
                { name: "Enseignement Scientifique", coef: 6 },
                { name: "EPS", coef: 6 },
                { name: "EMC", coef: 2 }
            ],
            bachibac: [
                { category: "√âpreuves Sp√©cifiques BachiBac" },
                { name: "Langue et Litt√©rature (√âcrit)", coef: 10, info: "Remplace LVA" },
                { name: "Langue et Litt√©rature (Oral)", coef: 10 },
                { name: "Hist-G√©o Espagnol (√âcrit+Oral)", coef: 15, info: "Remplace Hist-G√©o TC" },
                { category: "√âpreuves Communes" },
                { name: "Fran√ßais (√âcrit)", coef: 5 },
                { name: "Fran√ßais (Oral)", coef: 5 },
                { name: "Philosophie", coef: 8 },
                { name: "Grand Oral", coef: 10 },
                { name: "Sp√©cialit√© 1 (Terminale)", coef: 16 },
                { name: "Sp√©cialit√© 2 (Terminale)", coef: 16 },
                { category: "Contr√¥le Continu" },
                { name: "Sp√©cialit√© abandonn√©e (1√®re)", coef: 8 },
                { name: "LVB (Moyenne 1√®re+Term)", coef: 6 },
                { name: "Enseignement Scientifique", coef: 6 },
                { name: "EPS", coef: 6 },
                { name: "EMC", coef: 2 }
            ],
            pro: [
                { category: "Enseignements G√©n√©raux" },
                { name: "Fran√ßais / Histoire-G√©o", coef: 5 },
                { name: "Maths / Sciences", coef: 5 },
                { name: "LVA", coef: 4 },
                { name: "LVB", coef: 4 },
                { name: "Arts Appliqu√©s", coef: 2 },
                { name: "EPS", coef: 4 },
                { category: "Enseignements Professionnels" },
                { name: "Chef d'≈ìuvre", coef: 4 },
                { name: "√âpreuve Pro (EP1 - Pratique)", coef: 12 },
                { name: "√âpreuve Pro (EP2 - Dossier)", coef: 8 },
                { name: "√âconomie - Gestion / Droit", coef: 2 },
                { name: "Pr√©vention Sant√© Env.", coef: 2 }
            ]
        };

        let currentMode = null;

        // --- 2. LOCAL STORAGE LOGIC ---
        // Cl√©s uniques pour √©viter les conflits
        const LS_KEY_LAST_MODE = 'wikimind_bac_last_mode';
        const LS_PREFIX_DATA = 'wikimind_bac_data_';

        function saveToLocal() {
            if (!currentMode) return;
            
            const inputs = document.querySelectorAll('.grade-input');
            const dataToSave = {};
            
            inputs.forEach((input, index) => {
                dataToSave[index] = input.value;
            });

            try {
                localStorage.setItem(LS_PREFIX_DATA + currentMode, JSON.stringify(dataToSave));
                localStorage.setItem(LS_KEY_LAST_MODE, currentMode);
            } catch (e) {
                console.warn("Impossible de sauvegarder (Mode priv√© ?)", e);
            }
        }

        function loadFromLocal(mode) {
            try {
                const savedJson = localStorage.getItem(LS_PREFIX_DATA + mode);
                if (savedJson) {
                    const savedData = JSON.parse(savedJson);
                    const inputs = document.querySelectorAll('.grade-input');
                    inputs.forEach((input, index) => {
                        if (savedData[index] !== undefined) {
                            input.value = savedData[index];
                        }
                    });
                }
            } catch (e) {
                console.warn("Erreur chargement donn√©es", e);
            }
        }

        function initApp() {
            // V√©rifie s'il y a une derni√®re session
            try {
                const lastMode = localStorage.getItem(LS_KEY_LAST_MODE);
                if (lastMode && DATA[lastMode]) {
                    setMode(lastMode);
                }
            } catch (e) { console.log("Nouvelle session"); }
        }

        // --- 3. CORE FUNCTIONS ---

        function setMode(mode) {
            currentMode = mode;
            
            // Mise √† jour visuelle des boutons
            document.querySelectorAll('.stream-btn').forEach(btn => {
                btn.classList.remove('bg-black', 'text-white', 'border-black', 'ring-2', 'ring-offset-2');
                btn.classList.add('bg-white', 'text-black', 'border-gray-100');
            });
            const activeBtn = document.getElementById(`btn-${mode}`);
            activeBtn.classList.remove('bg-white', 'text-black', 'border-gray-100');
            activeBtn.classList.add('bg-black', 'text-white', 'border-black');

            // Afficher le calculateur
            const container = document.getElementById('calculator-container');
            container.classList.remove('hidden');
            
            // Titre
            const titles = { general: "Bac G√©n√©ral", bachibac: "Section BachiBac", pro: "Bac Pro / Techno" };
            document.getElementById('mode-title').innerText = titles[mode];

            renderInputs(mode);
            loadFromLocal(mode); // Charger les donn√©es sauvegard√©es
            updateCalculation(); // Lancer le calcul
            
            // Scroll doux vers le calculateur si ce n'est pas le chargement initial
            if (window.scrollY < 100) {
                 setTimeout(() => {
                    container.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }
            
            // Afficher la barre de r√©sultat
            document.getElementById('result-bar').classList.remove('translate-y-full');
            
            // Sauvegarder le mode actuel
            try { localStorage.setItem(LS_KEY_LAST_MODE, mode); } catch(e){}
        }

        function renderInputs(mode) {
            const grid = document.getElementById('inputs-grid');
            grid.innerHTML = '';

            DATA[mode].forEach((item, index) => {
                if (item.category) {
                    const separator = document.createElement('div');
                    separator.className = "md:col-span-2 mt-6 mb-2 pb-1 border-b border-gray-200";
                    separator.innerHTML = `<h4 class="font-bold text-xs text-gray-500 uppercase tracking-widest">${item.category}</h4>`;
                    grid.appendChild(separator);
                } else {
                    const div = document.createElement('div');
                    div.className = "input-group flex items-center justify-between bg-gray-50 p-4 rounded-xl border border-transparent hover:border-gray-300 hover:bg-white";
                    
                    div.innerHTML = `
                        <div class="flex flex-col pr-4">
                            <label class="font-bold text-sm leading-tight text-gray-800">${item.name}</label>
                            <span class="text-xs text-gray-400 font-mono mt-1">Coef. ${item.coef} ${item.info ? '‚Ä¢ ' + item.info : ''}</span>
                        </div>
                        <input type="number" 
                            min="0" max="20" step="0.5" 
                            placeholder="-"
                            inputmode="decimal"
                            class="grade-input w-20 text-right font-black text-xl bg-transparent border-b-2 border-gray-200 focus:border-black outline-none transition-colors p-1 text-black placeholder-gray-300"
                            data-coef="${item.coef}"
                            oninput="updateCalculationAndSave()">
                    `;
                    grid.appendChild(div);
                }
            });
        }

        function updateCalculationAndSave() {
            updateCalculation();
            saveToLocal();
        }

        function updateCalculation() {
            const inputs = document.querySelectorAll('.grade-input');
            let totalPoints = 0;
            let totalCoef = 0;
            let filledCount = 0;

            inputs.forEach(input => {
                let valStr = input.value.replace(',', '.'); // Accepte les virgules
                let val = parseFloat(valStr);
                const coef = parseFloat(input.dataset.coef);
                
                if (!isNaN(val)) {
                    filledCount++;
                    // Clamp visuel
                    if(val < 0) { val = 0; input.value = 0; }
                    if(val > 20) { val = 20; input.value = 20; }
                    
                    totalPoints += val * coef;
                    totalCoef += coef;
                }
            });

            const display = document.getElementById('final-grade');
            const mentionTag = document.getElementById('final-mention');
            
            // Si aucune note n'est entr√©e
            if (totalCoef === 0 || filledCount === 0) {
                display.innerText = "--/20";
                mentionTag.classList.add('hidden');
                return;
            }

            // Calcul Moyenne
            // Note: Pour une simulation "en cours", on divise par le coef total des mati√®res remplies
            // Mais pour le BAC r√©el, c'est le coef total absolu.
            // Ici, on fait une moyenne pond√©r√©e des notes RENTR√âES pour donner une estimation "courante"
            const average = totalPoints / totalCoef;
            const averageFormatted = average.toFixed(2);
            
            display.innerText = averageFormatted + "/20";

            // Gestion Mention
            mentionTag.classList.remove('hidden', 'bg-red-500', 'bg-yellow-500', 'bg-blue-500', 'bg-green-500', 'bg-purple-600', 'bg-black');
            mentionTag.className = "px-3 py-1 rounded-full text-white text-xs font-bold uppercase shadow-sm transform transition-all duration-300";

            if (average < 8) {
                mentionTag.innerText = "Refus√©";
                mentionTag.classList.add('bg-red-500');
            } else if (average < 10) {
                mentionTag.innerText = "Rattrapage";
                mentionTag.classList.add('bg-yellow-500');
            } else if (average < 12) {
                mentionTag.innerText = "Admis";
                mentionTag.classList.add('bg-blue-500');
            } else if (average < 14) {
                mentionTag.innerText = "Mention Assez Bien";
                mentionTag.classList.add('bg-green-500');
            } else if (average < 16) {
                mentionTag.innerText = "Mention Bien";
                mentionTag.classList.add('bg-black');
            } else {
                mentionTag.innerText = "Mention Tr√®s Bien";
                mentionTag.classList.add('bg-purple-600', 'shadow-purple-200');
            }
        }

        function resetCalculator() {
            if(confirm("Tout effacer ?")) {
                document.querySelectorAll('.grade-input').forEach(i => i.value = '');
                updateCalculationAndSave();
                // On nettoie aussi le localStorage pour ce mode
                try { localStorage.removeItem(LS_PREFIX_DATA + currentMode); } catch(e){}
            }
        }

        // Lancement au chargement
        window.addEventListener('DOMContentLoaded', initApp);

    </script>
</body>
</html>
